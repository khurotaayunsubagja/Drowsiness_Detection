# 🛏️ Drowsiness Detection Using YOLOv5 and Streamlit

This project was created to fulfill one of the assignments in my **Machine Learning** course. The aim is to develop a real-time system that can detect whether a driver is drowsy or awake by analyzing live video input. This system is designed to support road safety by providing early warnings if signs of drowsiness are detected during a trip.

The detection system is deployed using **Streamlit** on a local device. To make the system accessible remotely by the driver, the project uses **LocalXpose.io** to expose the Streamlit app running on localhost. The link generated by LocalXpose is then shared with the driver, who opens it using a device that has a **camera and speaker**. When the model detects that the driver is drowsy, a warning **alarm sound** is triggered on both the local monitoring device and the driver’s device, allowing real-time intervention.

---

## 📌 Project Purpose

- Created as a course assignment for **Machine Learning**
- Intended to help monitor **driver alertness** during long journeys
- Supports **real-time detection** and **warning system** for drowsiness

---

## 🧠 Model & Dataset Details

- **Model used**: YOLOv5
- **Annotation tool**: Roboflow
- **Dataset source**: Captured using my own face
- **Total images**: 100
- **Classes**:
  - `drowsy`
  - `awake`

---

## 🧪 Model Evaluation Results

After training the model for 5 epochs using 100 annotated images, the model produced the following evaluation metrics:

| Metric         | Value  | Explanation |
|----------------|--------|-------------|
| **Precision (P)**     | 0.826  | 82.6% of the model’s positive predictions are correct |
| **Recall (R)**        | 0.875  | 87.5% of actual drowsy/awake instances were correctly detected |
| **mAP@0.5**           | 0.861  | **Main accuracy metric**: 86.1% detection precision at IoU threshold 0.5 |
| **mAP@0.5:0.95**      | 0.473  | Average performance across stricter IoU thresholds (50–95%) |

These results show that the model has strong object detection performance despite using a relatively small dataset. Further improvements can be made by expanding the dataset, adding augmentations, and training for more epochs.

---

## 🛠️ Technologies Used

- Python  
- YOLOv5  
- OpenCV  
- Streamlit  
- Roboflow  
- LocalXpose.io  

---

## 🚀 How It Works

1. The model is trained using YOLOv5 with annotated data.
2. A Streamlit app (`app.py`) runs the model for real-time video detection.
3. The app is exposed to the internet using LocalXpose.
4. The driver accesses the detection interface through a link using a device with a camera and speaker.
5. When the driver is detected as drowsy:
   - An **alarm** sounds on the **local machine** (monitor)
   - The same **alarm** also sounds on the **driver's device**

---

## 📂 Project Structure

drowsiness-detection/
│
├── alarm/ # Alarm sound files
├── app.py # Streamlit app for detection and alarm
├── best.pt # Trained YOLOv5 model weights
├── requirements.txt # Python dependencies
├── train_model.ipynb # Notebook/script for training the model
└── README.md # Project documentation
